<?xml version="1.0" encoding="UTF-8"?><robot xmlns:xacro="http://www.ros.org/wiki/xacro">



<xacro:macro name="cart" params="parent *origin">

<material name="blue">
   <color rgba="0 0 0.8 1"/>
</material>
<material name="black">
   <color rgba="0 0 0 1"/>
</material>
<material name="white">
  <color rgba="1 1 1 1"/>
</material>

<!-- ball joint-->
  
      <joint name="yaw_robot_joint" type="revolute">
            <insert_block name="origin"/>
            <parent link="${parent}"/>
            <child link="fake_link1"/>
            <axis xyz="0 0 1 "/>
            <limit effort="150" velocity="12.0" lower="${-70*PI/180}" upper="${70*PI/180}"/>
      </joint>
       
      <joint name="pitch_robot_joint" type="revolute">
            <parent link="fake_link1"/>
            <child link="fake_link2"/>
            <axis xyz="0 0 1 "/>
            <origin xyz="0 0 0" rpy="-1.57 0 0"/>
             <limit effort="150" velocity="12.0" lower="${-70*PI/180}" upper="${70*PI/180}" />
      </joint>                 
                
      <joint name="roll_robot_joint" type="revolute">
            <parent link="fake_link2"/>
            <child link="link1"/>
            <axis xyz="0 0 1 "/>
            <origin xyz="0 0 0" rpy="0 -1.57 0"/>
             <limit effort="150" velocity="12.0" lower="${-70*PI/180}" upper="${70*PI/180}" />
      </joint>                 
                
       <link name="fake_link1">
            <inertial>
            <mass value="1"/>
            <inertia ixx="5.8083e-4" ixy="0" ixz="0" iyy="3.0833e-5" iyz="0" izz="5.9083e-4"/>
          </inertial>
        </link>     
        
        <link name="fake_link2">
            <inertial>
            <mass value="1"/>
            <inertia ixx="5.8083e-4" ixy="0" ixz="0" iyy="3.0833e-5" iyz="0" izz="5.9083e-4"/>
          </inertial>
        </link>     

       <link name="link1">
            <inertial>
            <mass value="1"/>
            <inertia ixx="5.8083e-4" ixy="0" ixz="0" iyy="3.0833e-5" iyz="0" izz="5.9083e-4"/>
          </inertial>
          <visual>
          <geometry>
           <cylinder length="0.5" radius="0.02"/>
         </geometry>
         <material name="blue"/>
         <origin rpy="0 0 0" xyz="0 0 0.25 "/>
       </visual>
        </link>
        <!--NB convention of subsequent rotations is YPR , the translation should be applied before in the previous parent frame-->
        <!-- the fixed frames are merged with the cart--> 
        <joint name="cart_attach" type="fixed">
            <parent link="link1"/>
            <child link="cart"/>
            <origin rpy="0 1.57 -1.57" xyz="0 0 0.5 "/>        
      </joint>          

     
       <link name="cart">
                  <inertial>
            <mass value="30"/>
            <inertia ixx="1" ixy="0" ixz="0" iyy="1" iyz="0" izz="1"/>
          </inertial>       
       <visual>
          <geometry>
              <box size="1.0 1.0 0.5"/>
         </geometry>
         <material name="black"/>
         <origin rpy="0 0 0" xyz="-0.5 0 0 "/>
       </visual>

       
     </link>
     
        <gazebo reference="cart">
            <material>Gazebo/Black</material>
        </gazebo>  
     
     <joint name="right_wheel_joint" type="continuous">
        <parent link="cart"/>
        <child link="right_wheel"/>
        <origin rpy="1.57 0 0" xyz=" -0.5 -0.5 -0.25"/>
         <axis xyz="0 0 1 "/>
      </joint>
     
     <link name="right_wheel">
                <inertial>
            <mass value="2"/>
            <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
          </inertial>
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0.1"/>
      <geometry>
        <cylinder length="0.1" radius="0.3"/>
      </geometry>
      <material name="blue"/>
    </visual>
    
   <collision>
      <origin rpy="0 0 0" xyz="0 0 0.1"/>
      <geometry>
        <cylinder length="0.1" radius="0.3"/>
      </geometry>
    </collision>
  </link>
  
          <gazebo reference="right_wheel">
            <material>Gazebo/Blue</material>
            <!-- kp and kd for rubber -->        
            <kp>1000000.0</kp>        
            <kd>100.0</kd>        
            <mu1>1.0</mu1>        
           <mu2>1.0</mu2>        
             <fdir1>1 0 0</fdir1>
            <maxVel>1.0</maxVel>
            <minDepth>0.00</minDepth>
        </gazebo>  
  
  <joint name="left_wheel_joint" type="continuous">
    <parent link="cart"/>
    <child link="left_wheel"/>
    <origin rpy="-1.57 0 0" xyz=" -0.5 0.5 -0.25"/>
     <axis xyz="0 0 1 "/>
  </joint>
     

  <link name="left_wheel">
             <inertial>
            <mass value="2"/>
            <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001"/>
          </inertial>
    <visual>
      <origin rpy="0 0 0" xyz="0 0 0.1"/>
      <geometry>
        <cylinder length="0.1" radius="0.3"/>
      </geometry>
      <material name="blue"/>
    </visual>
     <collision>
      <origin rpy="0 0 0" xyz="0 0 0.1"/>
      <geometry>
        <cylinder length="0.1" radius="0.3"/>
      </geometry>
    </collision>
  </link>
        
        <gazebo reference="left_wheel">
            <material>Gazebo/Blue</material>
            <!-- kp and kd for rubber -->        
            <kp>1000000.0</kp>        
            <kd>100.0</kd>        
            <mu1>1.0</mu1>        
           <mu2>1.0</mu2>        
             <fdir1>1 0 0</fdir1>
            <maxVel>1.0</maxVel>
            <minDepth>0.00</minDepth>
       </gazebo>     




</xacro:macro>

</robot>
